---
title: "Final Project - First Analysis"
subtitle: "Programming for Business Analytics (11410ISS 406600)"
output:
  pdf_document: default
author: "Group 10"
date: "2025-11-03"
---

# Group Member
Choonhanunt Amnuaychaikij 111006224
Panuvit Tuicharoen 111006105
Napat Leesaksakul 112006208
Thanutcha Amnajcharoensak 112006412
Nantachaporn Sudjai 112006431

In this report, we will analyze some of the interested business question by using the analysis techniques.

1. Does setting a higher price actually reduce the number of units people buy (Price Elasticity) by using correlation between Price vs Quantity.

2. Do highly-rated products generate more money per transaction? by using the linear regression between Rating vs Revenue.

3. Which product category is statistically the most consistent in quality? by using the confidence intervals.

# Library Setup
```{r}
library(tidyverse)
library(stringr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tidytext)
```

# Data Importing
```{r tidy=TRUE}
ecommerce <- read.csv('ecommerce_dataset_10000.csv')

head(ecommerce)
```

# Data Cleaning
```{r}
ecommerce <- ecommerce %>%
  mutate(
    order_year = year(ymd(order_date))
  )
```

# Data Preparation
```{r}
ecommerce <- ecommerce %>%
  mutate(
    total_amount = quantity * unit_price
  )
```

# Question 1: Correlation Analysis

We want to determine if a higher unit price relates to lower quantity purchased.
```{r}
cor_test <- cor.test(ecommerce$unit_price, ecommerce$quantity)

cor_test
```

We also make the visualization for the correlation
```{r}
ggplot(ecommerce, aes(x = unit_price, y = quantity)) +
  geom_jitter(alpha = 0.3, height = 0.2, color = "steelblue") +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(
    title = "Relationship between Unit Price and Quantity",
    subtitle = paste("Correlation Coefficient:", round(cor_test$estimate, 3)),
    x = "Unit Price ($)",
    y = "Quantity Ordered"
  ) + theme_minimal()
```

# Question 2: Linear Regression

We want to predict that if Customer Rating influences the Total Sales Amount.
```{r}
lm_model <- lm(total_amount ~ rating, data = ecommerce)

summary(lm_model)
```
Next we will proceed with the visualization,
```{r}
ggplot(ecommerce, aes(x = rating, y = total_amount)) +
  geom_jitter(alpha = 0.2, width = 0.2, color = "gray") +
  geom_smooth(method = "lm", color = "darkgreen", fill = "lightgreen") +
  labs(
    title = "Linear Regression: Effect of Rating on Total Sales",
    subtitle = paste("Slope:", round(coef(lm_model)[2], 2)),
    x = "Customer Rating (1-5)",
    y = "Total Transaction Amount ($)"
  ) + theme_minimal()
```

# Question 3: Confidence Intervals
As we want to find the true average rating for each product category with statistical confidence.

```{r}
category_ci <- ecommerce %>%
  group_by(category) %>%
  summarise(
    avg_rating = mean(rating),
    sd_rating = sd(rating),
    count = n(),
    se = sd_rating / sqrt(count),
    # CI 95% calculation
    ci_lower = avg_rating - (1.96 * se),
    ci_higher = avg_rating + (1.96 * se)
  )

category_ci
```

Next, we will working on the visualization for error bars.
```{r}
ggplot(category_ci, aes(x = reorder(category, avg_rating), y = avg_rating)) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_higher), width = 0.2, color = "darkblue") +
  geom_point(size = 3, color = "firebrick") + 
  labs(
    title = "95% Confidence Intervals for Product Ratings",
    x = "Product Category",
    y = "Average Rating (with 95% CI)"
  ) + coord_flip() + theme_minimal()
```